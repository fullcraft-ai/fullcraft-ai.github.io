<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶æ Refactoring d&#39;architecture mobile de contr√¥le de drone - Full Craft AI Solutions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="/favicon.ico">

  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair&#43;Display:wght@600&amp;family=Source&#43;Sans&#43;Pro:wght@400;700&amp;display=swap" rel="stylesheet">



  
  
  
  
    
  
  <link rel="stylesheet" href="/css/style.min.58585d903c6525d159316b4ae330e76d9dda01f548bdce11ee2f17a6dfa394e6.css">

  

  
    
    <meta property="og:title" content="ü¶æ Refactoring d&#39;architecture mobile de contr√¥le de drone"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="/posts/drone/"/>
    
    
    <meta name="twitter:card" content="summary"/>
    
    
  

</head>

<body class='page page-posts-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    
    
    <li class="menu-item-services ">
      <a href="/">
        <span>Services</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-√©quipe ">
      <a href="/team/">
        <span>√âquipe</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-case studies ">
      <a href="/posts/">
        <span>Case Studies</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-contact ">
      <a href="/contact/">
        <span>Contact</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="/"><img height=36px alt="Full Craft AI Solutions" src="/images/logo/logo-1.png" /></a>
    </div>
    <div class="logo-mobile">
      <a href="/"><img height=36px alt="Full Craft AI Solutions" src="/images/logo/logo-1.png" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    
    
    <li class="menu-item-services ">
      <a href="/">
        
        <span>Services</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-√©quipe ">
      <a href="/team/">
        
        <span>√âquipe</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-case studies ">
      <a href="/posts/">
        
        <span>Case Studies</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-contact ">
      <a href="/contact/">
        
        <span>Contact</span>
      </a>
    </li>
    
  </ul>
</div>

    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button" aria-label="Mobile Menu">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>

    

<div class="container pb-6 pt-6 pt-md-10 pb-md-10">
  <div class="row justify-content-start">
    <div class="col-12 col-md-8">
      <div class="service service-single">
        <h1 class="title">ü¶æ Refactoring d&#39;architecture mobile de contr√¥le de drone</h1>
        <div class="content"></p>
<p><img src="/images/posts/drone-illustration.png" alt="VeryStrictDNA Company"></p>
<h2 id="-lentreprise">ü¶ú L&rsquo;entreprise</h2>
<hr>
<p>Dans l&rsquo;incapacit√© de la citer, nous dirons simplement que c&rsquo;est une belle entreprise qui produit des <strong>drones de qualit√©
professionnelle</strong> ü§î</p>
<h2 id="-objectif">üéØ Objectif</h2>
<hr>
<p>Apr√®s des livraisons d&rsquo;une qualit√© douteuse de la part de son prestataire de d√©veloppement mobile, la direction a d√©cid√©
de mettre fin √† son contrat et de constituer une √©quipe de freelances pour remettre d&rsquo;aplomb la codebase et it√©rer
rapidement pour la sortie de son nouveau drone professionnel qui n&rsquo;attendait plus que l&rsquo;application mobile - uniquement
iOS (UIKit) dans un premier temps. De plus, une des promesses de cette application √©tait d&rsquo;en fournir une version
all√©g√©e et <strong>OS</strong>, permettant √† des partenaires de coder leurs propres comportements.</p>
<p>C&rsquo;est moi (Pierre) qui suis intervenu en tant que <strong>lead architect</strong>.</p>
<h2 id="-architecture-pragmatique">üë∑‚Äç‚ôÇÔ∏è Architecture pragmatique</h2>
<hr>
<p>MVC, MVP, MVVM, TCA&hellip; Les architectures iOS sont l√©gion. Si les conditions s&rsquo;y pr√™tent, je conseille TCA, qui offre les meilleures garanties et une SoC tr√®s stricte. Mais comme il s&rsquo;agit d&rsquo;une architecture tr√®s particuli√®re les condition n&rsquo;√©taient pas r√©unies pour s&rsquo;engager sur cette voie.</p>
<p>On distinguait un semblant de MVVM dans le code existant. Comme c&rsquo;est le mod√®le le plus r√©pandu actuellement et qu&rsquo;il est relativement bien compris par les d√©veloppeurs, nous sommes partis de cette base et l&rsquo;avons adapt√©e en MVVM + Coordinator.</p>
<p>Cependant, une fois le paradigme principal choisi, ce sont les conventions pratiques qui induisent √† la fois l&rsquo;efficacit√© du d√©veloppement et la qualit√© finale du code.</p>
<p>Je les ai √©tablies pour b√©n√©ficier des principales qualit√©s des mod√®les stricts tout en court-circuitant les conventions √† faible valeur ajout√©e pour augmenter tant que possible l&rsquo;efficacit√© du d√©veloppement.</p>
<p>Apr√®s <strong>l&rsquo;√©criture de guidelines</strong> ad√©quates nourries d&rsquo;exemples concrets et leur pr√©sentation √† l&rsquo;√©quipe, le travail a pu commencer.</p>
<h2 id="-refactor-par-√©tranglement-avec-7-d√©veloppeurs">üèóÔ∏è Refactor par √©tranglement avec 7 d√©veloppeurs</h2>
<hr>
<p>Nous √©tions une √©quipe cons√©quente sur ce projet, et heureusement ! Le lead dans ce contexte a repr√©sent√© une part
importante de mon travail. Expliquer, aider, review, soutenir, peer-coder&hellip;</p>
<p>Mais mon compromis d&rsquo;architecture pragmatique s&rsquo;est av√©r√© assez facile √† prendre en main pour que cette partie diminue
rapidement.</p>
<p>En pratique, nous avons √©tabli quelques r√®gles :</p>
<ul>
<li>tout ce qui peut √™tre remis d&rsquo;aplomb √† moindre frais doit l&rsquo;√™tre d√®s qu&rsquo;on effectue une quelconque modification dessus. On peut aller plus loin par capillarit√© lorsque c&rsquo;est assez direct, c&rsquo;est-√†-dire sans ajouter de temps de d√©veloppement trop important.</li>
<li>on me fait remonter toutes les parties du code qui n√©cessitent des modifications cons√©quentes (nouveau service, cr√©ation
de coordinator, remise √† plat du mod√®le&hellip;) pour pr√©voir le chantier</li>
<li>j&rsquo;√©cris la grande majorit√© de la couche service, et je review tout ce qui y touche significativement</li>
<li>partout o√π le refactor n&rsquo;est pas assez avanc√©, on injecte les services via un singleton pour identifier clairement les
zones √† refactor</li>
</ul>
<p>De plus, nous avons bien s√ªr attribu√© des r√¥les aux d√©veloppeurs selon leurs comp√©tences pour maximiser l&rsquo;efficacit√© des
attributions, et <strong>fait monter en comp√©tence toute l&rsquo;√©quipe</strong> sur les paradigmes de l&rsquo;architecture mais √©galement sur la
programmation r√©active avec Combine.</p>
<p>Enfin, j&rsquo;ai organis√© de grosses sessions de <strong>peer-programming</strong> pour les r√©gions les plus intriqu√©es du code avec les
d√©veloppeurs UI ou de l&rsquo;autre c√¥t√© avec les d√©veloppeurs du SDK bas niveau.</p>
<p>L&rsquo;objectif √©tait alors double : acc√©l√©rer le d√©veloppement des parties √† haute variance, mais aussi me confronter √†
toutes les couches de l&rsquo;application pour valider ou ajuster le mod√®le m√©tier.</p>
<p>Tr√®s vite, la mise √† plat √† la vol√©e du code UI existant a <strong>d√©gag√© une architecture concr√®te</strong> de services de feature UI et
de coordinators. Les zones legacy du code ont √©t√© cloisonn√©es progressivement, ce qui a d&rsquo;autant facilit√© leur
refactoring le moment venu. Et un <strong>ensemble de services coh√©rent</strong> a petit √† petit remplac√© les impl√©mentations √©parses des r√®gles business.</p>
<p>Pendant ce temps, <strong>l&rsquo;application restait testable</strong>, nous informions l&rsquo;√©quipe de QA des features refactor√©es √† tester
et consommions leurs retours.</p>
<h2 id="-d√©veloppement-des-services-critiques">üë®‚Äçüî¨ D√©veloppement des services critiques</h2>
<hr>
<p>En parall√®le, il s&rsquo;agissait √©galement de refactor et cr√©er les services en interaction avec le SDK bas niveau de
contr√¥le du drone, les diff√©rentes APIs et la persistance locale. Ici, pas question de prendre les raccourcis propres √†
l&rsquo;UI.</p>
<p>Au contraire, je n&rsquo;ai pas h√©sit√© √† multiplier les services, les <strong>machines √† √©tat</strong> et les mod√®les interm√©diaires
explicitant les r√®gles business unitaires de l&rsquo;app pour arriver √† un mod√®le simple expos√© √† l&rsquo;UI reposant sur <strong>des bases
solides et explicites</strong>.</p>
<p>La coop√©ration avec les √©diteurs (internes) du SDK a √©t√© cruciale, puisque certains besoins m√©tier ont d√©clench√© des
cha√Ænes de modification :
<strong>Mobile App -&gt; SDK (Swift) -&gt; Core SDK (C++) -&gt; Drone Firmware (Python / C++)</strong></p>
<p>La <strong>documentation</strong> d√©taill√©e des services est n√©cessaire - d&rsquo;autant plus pour la partie open-source, mais nous avons
eu la satisfaction de constater que, dans la plupart des cas, les interfaces des nouveaux services √©taient suffisamment
explicites pour √™tre consomm√©es <strong>sans ambig√ºit√©</strong> par les d√©veloppeurs en charge de l&rsquo;UI.</p>
<h2 id="-bilan">üìä Bilan</h2>
<hr>
<p>Ce drone constituait <strong>l&rsquo;√©tat de l&rsquo;art du drone professionnel</strong>, avec une myriade de fonctionnalit√©s (photogramm√©trie,
reconnaissance et suivi d&rsquo;individu, piste d&rsquo;atterrissage en mouvement, plan de vol,&hellip;). M√™me si toutes √©taient
th√©oriquement r√©alisables gr√¢ce au SDK, la confrontation au cahier des charges de haut niveau de l&rsquo;UX et aux
interactions possibles entre les fonctionnalit√©s (combinatoire gigantesque!) a d√©clench√© un raz-de-mar√©e de
probl√©matiques, d&rsquo;arbitrages et de modifications (que ce soit du SDK, des APIs, &hellip;ou du cahier des charges).</p>
<p>Malgr√© des conditions initiales peu rassurantes, une complexit√© sans √©quivoque et une √©quipe de freelances sans
connaissance pr√©alable du produit, nous avons tenu des d√©lais record tout en assurant une haute qualit√© de code,
d&rsquo;architecture, et une excellente stabilit√© de l&rsquo;application.</p>
<p><strong>En 6 mois, toute l&rsquo;infrastructure de l&rsquo;application avait √©t√© reprise et compl√©t√©e</strong>. Le drone est finalement arriv√© sur
le march√© avec <strong>un retard inf√©rieur √† celui calcul√© au lancement de la mission</strong>, et tout-√†-fait tol√©rable c
ommercialement.</p>
</div>
      </div>
    </div>
  </div>
</div>

  </div>

  <div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="footer-inner">
          <h3 class="footer-title">Full Craft AI Solutions</h3>
          <div id="footer-menu" class="footer-menu">
  <ul>
    
    
    
    
    <li class="menu-item-services ">
      <a href="/">
        
        <span>Services</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-√©quipe ">
      <a href="/team/">
        
        <span>√âquipe</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-case studies ">
      <a href="/posts/">
        
        <span>Case Studies</span>
      </a>
    </li>
    
    
    
    <li class="menu-item-contact ">
      <a href="/contact/">
        
        <span>Contact</span>
      </a>
    </li>
    
  </ul>
</div>

          
        </div>
      </div>
    </div>
  </div>
</div>


  

  




  

<script type="text/javascript" src="/js/services.min.9107b65a7df0422d8a274963e6b560062a6cdf62185570cfd584b43defa67279.js"></script>


  
    
  
  <script type="text/javascript" src="/js/scripts.min.8504133605a277da18f0d58cfd2e90d154962f4a961543a6e2f0a459a2d05462.js"></script>

  


  


</body>

</html>
